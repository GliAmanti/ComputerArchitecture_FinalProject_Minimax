From f328a99a4b40f62a7fed9fb9f267f4321dbdc5bd Mon Sep 17 00:00:00 2001
From: Graeme Smecher <gsmecher@threespeedlogic.com>
Date: Tue, 7 Mar 2023 15:33:18 -0800
Subject: [PATCH] Workaround: suppress emission of fence.i as part of trap
 handlers.

---
 riscv-test-suite/env/arch_test.h | 1 +
 1 file changed, 1 insertion(+)

diff --git a/riscv-test-suite/env/arch_test.h b/riscv-test-suite/env/arch_test.h
index e542123..400903d 100644
--- a/riscv-test-suite/env/arch_test.h
+++ b/riscv-test-suite/env/arch_test.h
@@ -128,6 +128,7 @@
   #define EXCPT_CAUSE_MSK ((1<<4)-1)
 #endif
 
+#define RVMODEL_FENCEI c.nop /* workaround until RISCOF handles this gracefully */
 #ifndef   RVMODEL_FENCEI
   #define RVMODEL_FENCEI fence.i                                // make sure ifetches get new code
 #endif
-- 
2.39.1

